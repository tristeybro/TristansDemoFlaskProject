name: Test

on: [push]

jobs:
    test:
        runs-on: ubuntu-latest
        steps:
         - uses: actions/checkout@v2
        
         - name: Setup Python
           uses: actions/setup-python@v1  
           with:
            python-version: 3.7

         - name: Install Python Dependencies With Pip
           run: pip install -r requirements.txt

         - name: Run Unit Tests
           run: pytest
    build_and_deploy:
        needs: test
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v2

        - name: Build Docker Image
          run: docker image build -t gcr.io/myflaskdemo/demo-app:1.0 .

